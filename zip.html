<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Zip Extractor</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<style>
body { font-family:'Arial'; background:#111; color:#eee; max-width:900px; margin:30px auto; padding:20px; transition:0.3s; }
h2{ font-family:'Arial',sans-serif;font-weight:bold;font-style:italic;font-size:32px;text-align:center;color:#fff;margin-bottom:20px;}
h3{ font-family:'Brush Script MT',cursive,'Segoe Script',sans-serif;font-size:22px;text-align:center;color:#ccc;margin-bottom:20px;}

.flex-container{display:flex; gap:30px;}
.flex-column{flex:1;}
.sidebar{width:280px;background:#222;padding:15px;border-radius:12px;max-height:700px;overflow-y:auto;border:1px solid #444;}
.sidebar h3{margin-top:0;color:#eee;}
.file-item{padding:10px 12px;margin:8px 0;background:#1a1a1a;border-radius:10px;cursor:grab;transition:0.2s;color:#eee;font-size:14px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;border:1px solid #444;}
.file-item:hover{background:#333;border-color:#555;}

.box{border:2px solid #eee;padding:25px;margin:15px 0;text-align:center;border-radius:12px;cursor:pointer;background:#222;color:#fff;font-weight:bold;font-style:italic;font-size:16px;transition:0.2s;}
.box:hover{background:#333;border-color:#fff;}

#checkoutBtn{padding:12px 22px;margin-top:20px;background:#111;border:1px solid #eee;border-radius:12px;cursor:pointer;color:#fff;font-weight:bold;font-style:italic;font-size:16px;transition:0.3s;}
#checkoutBtn:hover{background:#333;}

@media screen and (max-width:768px){
    .flex-container{flex-direction:column;}
    .sidebar{width:100%; max-height:250px; margin-bottom:15px;}
    .box{font-size:14px;padding:12px;}
    #checkoutBtn{width:100%; font-size:14px; padding:12px;}
    .file-item{font-size:13px;padding:8px;}
}
</style>

</head>
<body>

<h2>Zip Extractor</h2>

<div class="flex-container">
    <div class="sidebar">
        <h3>ZIP Files</h3>
        <div id="fileList">Drop ZIP above</div>
        <p style="font-size:13px;color:#ccc;">Upload a ZIP to extract follower/following files</p>
    </div>
    <div class="flex-column">
        <div class="box" id="zipBox">Click or Drop ZIP File</div>
        <b>Drag file to corresponding box:</b>
        <div class="box" id="followersBox">Followers Box</div>
        <div class="box" id="followingBox">Following Box</div>
        <button id="checkoutBtn">Send to Main Page</button>
    </div>
</div>

<input type="file" id="zipFile" hidden>

<script>
const zipBox = document.getElementById('zipBox');
const zipInput = document.getElementById('zipFile');
const fileList = document.getElementById('fileList');
const followersBox = document.getElementById('followersBox');
const followingBox = document.getElementById('followingBox');
const checkoutBtn = document.getElementById('checkoutBtn');

let filesFromZip = [];

// ZIP input handlers
zipBox.onclick = () => zipInput.click();
zipBox.ondragover = e => { e.preventDefault(); zipBox.style.background = "#f1d9ff"; }
zipBox.ondragleave = () => zipBox.style.background = "#222";
zipBox.ondrop = e => { e.preventDefault(); zipBox.style.background = "#222"; handleZip(e.dataTransfer.files[0]); }
zipInput.onchange = () => { if (zipInput.files.length) handleZip(zipInput.files[0]); }

// Handle ZIP file
async function handleZip(file) {
    if (!file.name.endsWith('.zip')) { alert('Not a ZIP file'); return; }
    const jszip = new JSZip();
    const zip = await jszip.loadAsync(file);
    fileList.innerHTML = '';
    filesFromZip = [];

    const entries = Object.values(zip.files).filter(f => {
        if (f.dir) return false;
        const filename = f.name.split('/').pop().toLowerCase(); // only last part of path
        return ['followers.json', 'following.json', 'followers_1.json', 'followers.html', 'following.html'].includes(filename);
    });

    for (const f of entries) {
        const content = await f.async("text");
        const filename = f.name.split('/').pop();
        const fileObj = { name: filename, content: content, type: null };
        filesFromZip.push(fileObj);

        const div = document.createElement('div');
        div.className = 'file-item';
        div.textContent = filename;
        div.draggable = true;
        div.addEventListener('dragstart', e => e.dataTransfer.setData('text/plain', filename));
        fileList.appendChild(div);
    }

    if (entries.length === 0) {
        alert("No follower/following files found in this ZIP.");
    }
}

// Make boxes drop targets
function makeDropTarget(box, type) {
    box.ondragover = e => e.preventDefault();
    box.ondrop = e => {
        e.preventDefault();
        const name = e.dataTransfer.getData("text/plain");
        const fileObj = filesFromZip.find(f => f.name === name);
        if (!fileObj) return;
        fileObj.type = type;
        box.textContent = fileObj.name;
    };
}

makeDropTarget(followersBox, 'followers');
makeDropTarget(followingBox, 'following');

// Checkout
checkoutBtn.onclick = () => {
    const selectedFiles = filesFromZip.filter(f => f.type);
    if (selectedFiles.length === 0) { alert("Select at least one file"); return; }
    localStorage.setItem('zipFiles', JSON.stringify(selectedFiles));
    window.location.href = 'index.html';
};
</script>

</body>
</html>
